<html>

<head>

<title>trakt.tv Login</title>
<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="jquery.sha1.js"></script>

<script type="text/javascript">

$(document).ready(function() {
  loadOptions();
});

function loadOptions() {
	var user = localStorage["username"];
	if(user.typeOf == "undefined")
		user = "";
	document.getElementById("username").value = user;

	$("#ckb_option_share_facebook").attr('checked', localStorage["option_share_facebook"] === "true" ? true : false);
	$("#ckb_option_share_twitter").attr('checked', localStorage["option_share_twitter"] === "true" ? true : false);
	$("#ckb_option_share_tumblr").attr('checked', localStorage["option_share_tumblr"] === "true" ? true : false);
	$("#ckb_option_share_foursquare").attr('checked', localStorage["option_share_foursquare"] === "true" ? true : false);


	testConnection(localStorage["username"],localStorage["password"]);
}

function saveOptions() {
	localStorage["username"] = document.getElementById("username").value;
	localStorage["password"] = $.sha1(document.getElementById("password").value);
	localStorage["option_share_facebook"] = $("#ckb_option_share_facebook").prop('checked');
	localStorage["option_share_twitter"] = $("#ckb_option_share_twitter").prop('checked');
	localStorage["option_share_tumblr"] = $("#ckb_option_share_tumblr").prop('checked');
	localStorage["option_share_foursquare"] = $("#ckb_option_share_foursquare").prop('checked');
	testConnection(localStorage["username"],localStorage["password"]);
}

function testConnection(vu,vp)
{
	$("#status").html('<img id="trakt-loading" src="'+chrome.extension.getURL("load.gif")+'">');
	$.getJSON('http://legendarydefense.net/trakt/trakt_testuser.php?trakt_user='+vu+'&trakt_pass='+vp, function(data) 
  	{
  	 if(data.status=="success")
  	 {
  		$("#status").html("<b style='color:green'>successfully connected</b>");
  	 }
  	 else
  	 {
  		$("#status").html("<b style='color:red'>failure</b>");
  	 }
  	});
}

function eraseOptions() {
	localStorage.removeItem("username");
	localStorage.removeItem("password");
	location.reload();
}
    
</script>


</head>

<body>
<center>
    <h1>trakt.tv Login</h1>

<table>
<tr> <td>Username:</td> <td><input id="username" size="8"></td> </tr>
<tr> <td>Password:</td> <td><input id="password" size="8" type="password"></td> </tr>
</table>

	<div id="status"></div><div id="status2"></div>
    <br />
<b>Options:</b><br>
	share checkins: 
	<input type="checkbox" name="option2" id="ckb_option_share_facebook" value="facebook"> facebook 
	<input type="checkbox" id="ckb_option_share_twitter" value="twitter"> twitter 
	<input type="checkbox" id="ckb_option_share_tumblr" value="tumblr"> tumblr 
	<input type="checkbox" id="ckb_option_share_foursquare" value="foursquare"> foursquare

<br><br>
<b>Status:</b><br>
http://trakt.tv: <img src="http://trakt.us/images/arrow-down-on.png" alt="status" onerror="this.src=chrome.extension.getURL('offline.png')" onload="this.src=chrome.extension.getURL('online.png')"/>
    
<br><br>
<button onclick="saveOptions()">save</button>
<button onclick="eraseOptions()">delete</button>
<button onclick="loadOptions()">load</button> 
<br>
<a href="http://trakt.tv/join" target="_blank">Register at trakt.tv</a>
    
</center>

<script type="text/javascript"><!--
google_ad_client = "ca-pub-3003920357099437";
/* asd */
google_ad_slot = "5942724741";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</body>

</html>
